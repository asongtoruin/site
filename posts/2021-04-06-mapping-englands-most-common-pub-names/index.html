<!DOCTYPE html>
<html lang="en">
<head>
  <script src="https://kit.fontawesome.com/5063c00b10.js"></script>
  
    <title>Mapping England&#39;s Most Common Pub Names :: ruszkow.ski — data, graphs and other nonsense</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="description" content="After making my graphs about the most common pub names in each country in Great Britain, one thing that really stood out was just how many pubs in England are called Red Lion. Being from the Midlands that made a lot of sense to me, but a few people who I showed it to seemed quite surprised. That got me thinking about what kind of regional variation there is in pub names."/>
<meta name="keywords" content=""/>
<meta name="robots" content="noodp"/>
<link rel="canonical" href="https://ruszkow.ski/posts/2021-04-06-mapping-englands-most-common-pub-names/" />


<link rel="stylesheet" href="https://ruszkow.ski/assets/style.css">

  <link rel="stylesheet" href="https://ruszkow.ski/assets/green.css">



<link rel="stylesheet" href="https://ruszkow.ski/style.css">


<link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://ruszkow.ski/img/apple-touch-icon-144-precomposed.png">

<link rel="shortcut icon" href="https://ruszkow.ski/img/favicon/green.png">



<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="Mapping England&#39;s Most Common Pub Names :: ruszkow.ski — data, graphs and other nonsense" />
<meta name="twitter:description" content="After making my graphs about the most common pub names in each country in Great Britain, one thing that really stood out was just how many pubs in England are called Red Lion. Being from the Midlands that made a lot of sense to me, but a few people who I showed it to seemed quite surprised. That got me thinking about what kind of regional variation there is in pub names." />
<meta name="twitter:site" content="https://ruszkow.ski" />
<meta name="twitter:creator" content="Adam" />
<meta name="twitter:image" content="https://ruszkow.ski/img/graphs/pub-names/england-local-authorities.png">


<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Mapping England&#39;s Most Common Pub Names :: ruszkow.ski — data, graphs and other nonsense">
<meta property="og:description" content="After making my graphs about the most common pub names in each country in Great Britain, one thing that really stood out was just how many pubs in England are called Red Lion. Being from the Midlands that made a lot of sense to me, but a few people who I showed it to seemed quite surprised. That got me thinking about what kind of regional variation there is in pub names." />
<meta property="og:url" content="https://ruszkow.ski/posts/2021-04-06-mapping-englands-most-common-pub-names/" />
<meta property="og:site_name" content="Mapping England&#39;s Most Common Pub Names" />
<meta property="og:image" content="https://ruszkow.ski/img/graphs/pub-names/england-local-authorities.png">
<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">

<meta property="article:published_time" content="2021-04-06 22:10:11 &#43;0100 &#43;0100" />











</head>
<body class="">



<div class="container center">


  
    <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="/">
  <div class="logo">
    ruszkow.ski
  </div>
</a>

    </div>
    <div class="menu-trigger">menu</div>
  </div>
  
    <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="/posts">Posts</a></li>
        
      
        
          <li><a href="/graphs">Graphs</a></li>
        
      
        
          <li><a href="/about">About</a></li>
        
      
      
    

    
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="/posts">Posts</a></li>
      
    
      
        <li><a href="/graphs">Graphs</a></li>
      
    
      
        <li><a href="/about">About</a></li>
      
    
    
  </ul>
</nav>

  
</header>

  

  <div class="content">
    
<div class="post">
  <h1 class="post-title">
  <a href="https://ruszkow.ski/posts/2021-04-06-mapping-englands-most-common-pub-names/">Mapping England&rsquo;s Most Common Pub Names</a></h1>
<div class="post-meta">
    
    <span class="post-date">
      <i class="fas fa-calendar-day"></i> 2021-04-06
    </span>
    
    
    <span class="post-author">::
      <i class="fas fa-user"></i> Adam
    </span>
    
    <span class='post-reading-time'>::
     <i class="fas fa-clock"></i> 5 minutes
    </span>
</div>


<span class="post-tags">
  
  #<a href="https://ruszkow.ski/tags/python/">Python</a>&nbsp;
  
  #<a href="https://ruszkow.ski/tags/qgis/">QGIS</a>&nbsp;
  
</span>


  
  <div class="img-outer">
    <a href="https://ruszkow.ski/img/graphs/pub-names/england-local-authorities.png" target="_blank">
      <img class="scaled-img" src="https://ruszkow.ski/img/graphs/pub-names/england-local-authorities.png">
    </a>
  </div>
  
  <div class="post-content">
    <p>After making my <a href="/graphs/2021-03-23-pub-names/">graphs</a> about the most common pub names in each country in Great Britain, one thing that really stood out was just how many pubs in England are called <em>Red Lion</em>. Being from the Midlands that made a lot of sense to me, but a few people who I showed it to seemed quite surprised. That got me thinking about what kind of regional variation there is in pub names. So, why not look at the most popular pub names by local authority? This gives us a chance to dig into QGIS a bit, which I tend to use a lot at work for producing maps but haven&rsquo;t talked about on here yet. Let&rsquo;s dive in.</p>
<h2 id="data-sources">Data Sources</h2>
<p>I started with the same OpenStreetMap data that I used in the graphs with the same cleaning applied for the names as it was all already geolocated, giving us a set of points representing each pub.</p>
<p>Next up - getting the local authority boundaries. Generally, the best UK source for standard boundaries is Ordnance Survey. Its <a href="https://www.ordnancesurvey.co.uk/business-government/products/boundaryline">Boundary Line</a> product includes the local authority boundaries alongside multiple other regional definitions. One slight oddity in the local authority boundaries provided is that the City of London is provided separately to Greater London. For my purposes that&rsquo;s a bit too refined, so I merged the two into one region and extracted only the England local authorities.</p>
<h2 id="merging-the-shapefiles">Merging The Shapefiles</h2>
<p>Combining spatial data involves doing a spatial join - joining the layers of data together according to their location in space. As we have a point layer for our pubs and polygons for our local authorities, it&rsquo;s a fairly straightforward join to apply.</p>
<p>There are a few different ways you could go about this - QGIS itself can handle spatial joins, but as we want to get the most <em>popular</em> name within each local authority keeping it all in Python means <code>geopandas</code> can handle this at the same time. You can find the code <a href="https://github.com/asongtoruin/data_analysis/blob/master/pub%20names/local_authorities.py">here</a>.</p>
<h2 id="displaying-the-results">Displaying The Results</h2>
<p>Once we have the output from the above script, that can be dropped straight into QGIS.</p>
<p>I was torn over how to display the summaries - at first I tried outlining each local authority and adding a label, but that resulted in an extremely messy map that was a bit overwhelming to read. Applying randomised colours to that made it a little easier to associate each label with its corresponding region, but then it became confusing that the colours didn&rsquo;t actually mean anything.</p>
<p>Instead, I noticed that a few names were appearing a lot of times and some others only once. Instead, I used QGIS' Categorised Symbology settings to assign a colour for every unique label, and started deleting the less-commonly occurring names so those regions would instead show up in the &ldquo;All others&rdquo; category. At this point I chose to merge together &ldquo;Bull&rdquo;, &ldquo;Bulls&rdquo; and &ldquo;Black Bull&rdquo; as they&rsquo;re all pretty similar names.</p>
<p>A few regions had a tie for the most common name. Fortuitously for me, we didn&rsquo;t get any regions where we&rsquo;d need to use more than two colours, so I decided stripes would be an easy way to represent a tie. I had to manually go through and set up the styling for each of these ties within the category settings, which was a bit of a faff but thankfully didn&rsquo;t take too long.</p>
<h2 id="making-the-colours-accessible">Making The Colours Accessible</h2>
<p>With my first attempt at this, the colours QGIS applied by default were pretty garish and wouldn&rsquo;t have been very useful to any colourblind observers. In searching for a colourblind-friendly palette, I found <a href="https://davidmathlogic.com/colorblind/#%23D81B60-%231E88E5-%23FFC107-%23004D40">this</a> excellent write-up from David Nichols which in turn directed me to Paul Tol&rsquo;s beautiful <a href="https://personal.sron.nl/~pault/">colourblind-friendly palette</a>. Once again, I got pretty lucky in that my map didn&rsquo;t need more colours than the palette provides.</p>
<h2 id="fine-tuning">Fine-Tuning</h2>
<p>At this point the map was pretty much done, but there were a few final tweaks to do. Adding a drop-shadow to the whole layer to gives the map a bit more of a presence on the page, and makes it look a bit neater. QGIS also has a lovely &ldquo;Print Layout&rdquo; feature which lets you combine a map with various other decorations like legends and labels to create something ready for print, which let me add in the extra features you see.</p>
<p>The other big change I chose to make was to add labels for any use of the &ldquo;All others&rdquo; colouration. Ths ensures that as much data was available to the viewer as possible while not being too overwhelming. It was, however, probably the most fiddly part of the whole setup as labelling the striped sections required a very specific labelling rule:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">CASE</span> 
<span style="color:#66d9ef">WHEN</span> strpos(<span style="color:#e6db74">&#34;name_short&#34;</span>, <span style="color:#e6db74">&#39;Red Lion&#39;</span>) <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span> <span style="color:#66d9ef">THEN</span> 
	<span style="color:#66d9ef">if</span>(
	  <span style="color:#e6db74">&#34;name_short&#34;</span> <span style="color:#f92672">!=</span> <span style="color:#e6db74">&#39;Red Lion&#39;</span>, 
	  <span style="color:#66d9ef">replace</span>(<span style="color:#66d9ef">replace</span>(<span style="color:#e6db74">&#34;name_short&#34;</span>, <span style="color:#e6db74">&#39;Red Lion, or &#39;</span>, <span style="color:#e6db74">&#39;&#39;</span>), <span style="color:#e6db74">&#39;, or Red Lion&#39;</span>, <span style="color:#e6db74">&#39;&#39;</span>), 
	  <span style="color:#e6db74">&#39;&#39;</span>
	)
<span style="color:#66d9ef">WHEN</span> strpos(<span style="color:#e6db74">&#34;name_short&#34;</span>, <span style="color:#e6db74">&#39;Kings&#39;</span>) <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span> <span style="color:#66d9ef">THEN</span> 
	<span style="color:#66d9ef">if</span>(
	  <span style="color:#e6db74">&#34;name_short&#34;</span> <span style="color:#f92672">!=</span> <span style="color:#e6db74">&#39;Kings&#39;</span>, 
	  <span style="color:#66d9ef">replace</span>(<span style="color:#66d9ef">replace</span>(<span style="color:#e6db74">&#34;name_short&#34;</span>, <span style="color:#e6db74">&#39;Kings, or &#39;</span>, <span style="color:#e6db74">&#39;&#39;</span>), <span style="color:#e6db74">&#39;, or Kings&#39;</span>, <span style="color:#e6db74">&#39;&#39;</span>), 
	  <span style="color:#e6db74">&#39;&#39;</span>
	)
<span style="color:#66d9ef">WHEN</span> strpos(<span style="color:#e6db74">&#34;name_short&#34;</span>, <span style="color:#e6db74">&#39;Crown&#39;</span>) <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span> <span style="color:#66d9ef">THEN</span> 
	<span style="color:#66d9ef">if</span>(
	  <span style="color:#e6db74">&#34;name_short&#34;</span> <span style="color:#f92672">!=</span> <span style="color:#e6db74">&#39;Crown&#39;</span>, 
	  <span style="color:#66d9ef">replace</span>(<span style="color:#66d9ef">replace</span>(<span style="color:#e6db74">&#34;name_short&#34;</span>, <span style="color:#e6db74">&#39;Crown, or &#39;</span>, <span style="color:#e6db74">&#39;&#39;</span>), <span style="color:#e6db74">&#39;, or Crown&#39;</span>, <span style="color:#e6db74">&#39;&#39;</span>), 
	  <span style="color:#e6db74">&#39;&#39;</span>
	)
<span style="color:#66d9ef">WHEN</span> strpos(<span style="color:#e6db74">&#34;name_short&#34;</span>, <span style="color:#e6db74">&#39;Wheatsheaf&#39;</span>) <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span> <span style="color:#66d9ef">THEN</span> 
	<span style="color:#66d9ef">if</span>(
	  <span style="color:#e6db74">&#34;name_short&#34;</span> <span style="color:#f92672">!=</span> <span style="color:#e6db74">&#39;Wheatsheaf&#39;</span>, 
	  <span style="color:#66d9ef">replace</span>(<span style="color:#66d9ef">replace</span>(<span style="color:#e6db74">&#34;name_short&#34;</span>, <span style="color:#e6db74">&#39;Wheatsheaf, or &#39;</span>, <span style="color:#e6db74">&#39;&#39;</span>), <span style="color:#e6db74">&#39;, or Wheatsheaf&#39;</span>, <span style="color:#e6db74">&#39;&#39;</span>), 
	  <span style="color:#e6db74">&#39;&#39;</span>
	)
<span style="color:#66d9ef">WHEN</span> <span style="color:#e6db74">&#34;name_short&#34;</span> <span style="color:#66d9ef">in</span> (<span style="color:#e6db74">&#39;Black Bull&#39;</span>, <span style="color:#e6db74">&#39;Bull&#39;</span>, <span style="color:#e6db74">&#39;Bulls&#39;</span>, <span style="color:#e6db74">&#39;Railway&#39;</span>, <span style="color:#e6db74">&#39;White Horse&#39;</span>) <span style="color:#66d9ef">THEN</span> 
    <span style="color:#e6db74">&#39;&#39;</span>
<span style="color:#66d9ef">ELSE</span>
    <span style="color:#e6db74">&#34;name_short&#34;</span>
<span style="color:#66d9ef">END</span>
</code></pre></div><p>This&hellip; works, but is rather inelegant and extremely fragile. As this is a one-off map, I&rsquo;m not too worried about this, but for any kind of ongoing analysis, I wouldn&rsquo;t recommend using something quite so hard-coded.</p>

  </div>
  
  <div class="pagination">
    <div class="pagination__title">
      <span
        class="pagination__title-h">Read other posts</span>
      <hr />
    </div>
    <div class="pagination__buttons">
      
      
      <span class="button next">
        <a href="https://ruszkow.ski/posts/2021-01-21-github-actions-on-a-schedule/">
          <span class="button__text">GitHub Actions on a Schedule</span>
          <span class="button__icon">→</span>
        </a>
      </span>
      
    </div>
  </div>
  

  

</div>

  </div>

  
    
      <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright">
        <span>© 2021 Powered by <a href="http://gohugo.io">Hugo</a></span>
    
        <span>:: Theme made by <a href="https://twitter.com/panr">panr</a></span>
      </div>
  </div>
</footer>

<script src="https://ruszkow.ski/assets/main.js"></script>
<script src="https://ruszkow.ski/assets/prism.js"></script>





    
  
</div>

</body>
</html>
